<script>
    const nav = shadowDocument.querySelector("nav");

    window.onscroll = function () { stickyNavbar() };

    var sticky = nav.offsetTop;

    function stickyNavbar() {
        if (window.pageYOffset >= sticky) {
            nav.classList.add("sticky")
        } else {
            nav.classList.remove("sticky");
        }
    }

    shadowDocument.querySelectorAll("a.navlink").forEach(a => {
        a.addEventListener("click", function (event) {
            event.preventDefault();
            nav.querySelector(".active").classList.remove("active");
            event.target.classList.add("active");
            const url = event.target.getAttribute("href");
            go(url);
        });
    });
    // Back button clicked
    window.addEventListener("popstate", function (event) {
        // TODO: fix back button
        if (event.state) {
            go(event.state.route, false);
        }
    });

    window.go = function (route, addToHistory = true) {
        if (addToHistory) {
            history.pushState({ route }, null, route);
        }
        let section = null;
        switch (route) {
            case "/animals": {
                section = document.createElement("animals-view");
                const animals = [{"id": 1, "animal": "Alligator", "sound": "Snap!", "icon": "üêä" },{ "id": 2, "animal": "Lion", "sound": "Roaar!", "icon": "ü¶Å" },{ "id": 3, "animal": "Cat", "sound": "Meaow!", "icon": "üê±" }];
                section.dataset.state = JSON.stringify(animals);
                break;
            }
            default:
        }
        const main = shadowDocument.querySelector("main");
        main.replaceChildren();

        if (section) {
            main.appendChild(section);
            // move to top
            window.scrollX = 0;
            window.scrollY = 0;
        }
        shadowDocument.querySelectorAll("a.navlink").forEach(a => {
            a.classList.remove("active");
            if (a.getAttribute("href") == location.pathname) {
                a.classList.add("active");
            }
        });
    }
    // Check the initial URL
    go(location.pathname);
</script>

<style>
    nav {
        background-color: #144000;
        overflow: hidden;
        margin: 0;
    }

    nav a {
        float: left;
        color: #ffd700;
        display: block;
        text-align: center;
        padding: 4vh;
        text-decoration: none;
        font-size: 4vh;
        font-weight: 600;
    }

    nav a:hover {
        background-color: #ffff00;
        color: #144000;
    }

    nav a.active {
        background-color: #ffd700;
        color: #144000;
    }

    nav a.hidden {
        display: none;
    }

    .sticky {
        position: fixed;
        top: 0;
        width: 100%;
    }
</style>

<template>
    <home-header></home-header>
    <nav>
        <a class="navlink active" href="/">üè†</a>
        <a class="navlink" href="/animals">Animals</a>
    </nav>
    <main></main>
</template>